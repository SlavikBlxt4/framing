package com.example.demo.service;

import com.example.demo.model.User;
import com.example.demo.repository.ServiceRepository;
import com.example.demo.repository.UserRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class serviceService {

    @Autowired
    private ServiceRepository serviceRepository;

    @Autowired
    private UserRepository userRepository;

    // Metodo para crear un servicio
    public Service createService(Service service, Integer photographerId) {
        // Obtener el fotógrafo
        User photographer = userRepository.findById(photographerId)
                .orElseThrow(() -> new RuntimeException("Fotógrafo no encontrado"));

        // Verificar que el usuario tiene el rol de fotógrafo
        if (!"photographer".equals(photographer.getRole())) {
            throw new RuntimeException("El usuario no es un fotógrafo");
        }

        // Asignar el fotógrafo al servicio
        service.setPhotographer_id(photographer);

        // Guardar el servicio
        return serviceRepository.save(service);
    }
}
